---
import { getCollection } from 'astro:content';
import { getRelativeLocaleUrl } from 'astro:i18n';
import Layout from '../../layouts/Layout.astro';
import RecipeCard from '../../components/RecipeCard.astro';

const currentLocale = Astro.currentLocale || 'en';

// Get all recipes for the current language
const allRecipes = await getCollection('recipes', (entry) => {
	return entry.data.lang === currentLocale;
});

// Sort recipes by title
const recipes = allRecipes.sort((a, b) => a.data.title.localeCompare(b.data.title));

const content = {
	title: 'Eat',
	subtitle: "Recipes I've Tried & Loved",
	description: "This is a collection of recipes I've personally tried and they've become part of my healthy eating journey. All recipes are simple, nutritious, and of course, delicious!",
	noRecipes: 'No recipes added yet.',
	totalRecipes: `${recipes.length} recipe${recipes.length !== 1 ? 's' : ''} in my collection`,
	allRecipes: 'All Recipes'
};
---

<Layout title={content.title} lang={currentLocale}>
	<div class="min-h-screen bg-gray-50">
		<!-- Header Section -->
		<section class="bg-gradient-to-r from-green-500 to-emerald-600 text-white py-16">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<div class="text-center">
					<h1 class="text-4xl md:text-5xl font-bold mb-4">
						{content.title}
					</h1>
					<p class="text-xl md:text-2xl text-green-100 mb-6 max-w-3xl mx-auto">
						{content.subtitle}
					</p>
					<p class="text-lg text-green-200 max-w-2xl mx-auto">
						{content.description}
					</p>
				</div>
			</div>
		</section>

		<!-- Recipes Section -->
		<section class="py-12">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<div class="flex justify-between items-center mb-8">
					<h2 class="text-2xl font-bold text-gray-900">
						{content.allRecipes}
					</h2>
					<p class="text-gray-600">
						{content.totalRecipes}
					</p>
				</div>

				{recipes.length > 0 ? (
					<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
						{recipes.map((recipe) => (
							<RecipeCard recipe={recipe} lang={currentLocale} />
						))}
					</div>
				) : (
					<div class="text-center py-16">
						<div class="text-6xl mb-4">üçΩÔ∏è</div>
						<h3 class="text-xl font-medium text-gray-900 mb-2">
							{content.noRecipes}
						</h3>
						<p class="text-gray-600">
							Check back soon for new recipes!
						</p>
					</div>
				)}
			</div>
		</section>

		<!-- Filter Section (for future enhancement) -->
		<section class="bg-white py-8 border-t">
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
				<div class="text-center">
					<p class="text-gray-500 text-sm">
						More filtering options coming soon!
					</p>
				</div>
			</div>
		</section>
	</div>
</Layout>